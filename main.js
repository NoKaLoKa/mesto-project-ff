(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{Z0:()=>v,OP:()=>f,Z1:()=>y}),fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/cards",{headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854"}}).then((function(t){return t.json()})).then((function(t){t.forEach((function(t){var e=r(t,c,i,y),o=e.querySelector(".card__like-сounter"),n=e.querySelector(".card__delete-button");"a5cd3f67283bc26d3ca91bb7"!==t.owner._id&&n.remove(),v(e),o.textContent=t.likes.length}))})).catch((function(t){console.log(t)}));var e=function(t){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/cards/".concat(t._id),{method:"DELETE",headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854"}})},o=function(t){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/cards/likes/".concat(t._id),{method:"PUT",headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854","Content-Type":"application/json"}})},n=function(t){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/cards/likes/".concat(t._id),{method:"DELETE",headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854","Content-Type":"application/json"}})};function r(t,r,c,i){var u=f.content.cloneNode(!0),a=u.querySelector(".card__image"),p=u.querySelector(".card__title"),s=u.querySelector(".card__delete-button"),_=u.querySelector(".card__like-button"),l=u.querySelector(".card__like-сounter");return s.addEventListener("click",(function(){r(s),e(t)})),_.addEventListener("click",(function(){c(_),t.likes.some((function(t){return"a5cd3f67283bc26d3ca91bb7"===t._id}))?(n(t),l.textContent=t.likes.length-1):(o(t),l.textContent=t.likes.length+1)})),a.addEventListener("click",(function(){return i(a)})),a.src=t.link,a.alt=t.name,p.textContent=t.name,u}function c(t){t.closest(".card").remove()}function i(t){t.classList.toggle("card__like-button_is-active")}function u(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",p)}function a(t){document.removeEventListener("keydown",p),t.classList.remove("popup_is-opened")}function p(t){"Escape"===t.key&&a(document.querySelector(".popup_is-opened"))}function s(t,e,o){var n=t.querySelector(".".concat(e.id,"-input-error"));e.classList.add("popup__input_type_error"),n.classList.add("popup__input-error_active"),n.textContent=o}function _(t,e){e.validity.patternMismatch?s(t,e,e.dataset.errorMessage):e.validity.valid?function(t,e){var o=t.querySelector(".".concat(e.id,"-input-error"));e.classList.remove("popup__input_type_error"),o.classList.remove("popup__input-error_active"),o.textContent=""}(t,e):s(t,e,e.validationMessage)}function l(t,e){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?e.classList.remove("button__inactive"):e.classList.add("button__inactive")}function d(t,e){var o=Array.from(t.querySelectorAll(e.inputSelector)),n=t.querySelector(e.submitButtonSelector);l(o,n),o.forEach((function(e){e.addEventListener("input",(function(){_(t,e),l(o,n)})),_(t,e)}))}var f=document.querySelector("#card-template"),m=document.querySelector(".places__list");function v(t){m.append(t)}function y(t){var e=t.parentElement,o=e.querySelector(".card__image"),n=e.querySelector(".card__title");document.querySelector(".popup__image").src=o.src,document.querySelector(".popup__image").alt=o.alt,document.querySelector(".popup__caption").textContent=n.textContent,u(C)}var h=document.querySelector(".profile__edit-button"),S=document.querySelector(".popup_type_edit");h.addEventListener("click",(function(){x.value=k.textContent,T.value=w.textContent,d(g,{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:".button__inactive",inputErrorClass:".popup__input_type_error",errorClass:".popup__input-error_active"}),u(S)}));var b=document.querySelector(".profile__add-button"),q=document.querySelector(".popup_type_new-card");b.addEventListener("click",(function(){d(j,{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:".button__inactive",inputErrorClass:".popup__input_type_error",errorClass:".popup__input-error_active"}),u(q)}));var C=document.querySelector(".popup_type_image"),E=document.querySelector(".popup_type_avatar"),L=document.querySelector(".profile__image");document.querySelector(".profile__image-container").addEventListener("click",(function(){d(A,{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:".button__inactive",inputErrorClass:".popup__input_type_error",errorClass:".popup__input-error_active"}),u(E)})),document.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&a(document.querySelector(".popup_is-opened"))}));var g=document.forms["edit-profile"],k=document.querySelector(".profile__title"),w=document.querySelector(".profile__description"),x=g.querySelector(".popup__input_type_name"),T=g.querySelector(".popup__input_type_description");!function(t,e,o){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/users/me",{headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854"}}).then((function(t){return t.json()})).then((function(n){t.textContent=n.name,e.textContent=n.about,o.setAttribute("style","background-image: url(".concat(n.avatar,")"))}))}(k,w,L),g.addEventListener("submit",(function(t){t.preventDefault();var e=x.value,o=T.value;k.textContent=e,w.textContent=o,function(t,e){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/users/me",{method:"PATCH",headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854","Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t),about:"".concat(e)})})}(e,o),a(S)}));var j=document.forms["new-place"],B=j.querySelector(".popup__input_type_card-name"),z=j.querySelector(".popup__input_type_url");j.addEventListener("submit",(function(t){t.preventDefault();var e={name:B.value,link:z.value};m.prepend(r(e,c,i,y)),function(t){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/cards",{method:"POST",headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854","Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t.name),link:"".concat(t.link)})})}(e),j.reset(),a(q)}));var A=document.forms.avatar,O=A.querySelector(".popup__input_type_url");A.addEventListener("submit",(function(t){t.preventDefault();var e=O.value;document.querySelector(".profile__image").setAttribute("style","background-image: url(".concat(e,")")),function(t){fetch("https://mesto.nomoreparties.co/v1/wff-cohort-2/users/me/avatar",{method:"PATCH",headers:{authorization:"44bd843a-83af-4683-8cc6-5f335d510854","Content-Type":"application/json"},body:JSON.stringify({avatar:"".concat(t)})})}(e),A.reset(),a(E)})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),d(t,{formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:".button__inactive",inputErrorClass:".popup__input_type_error",errorClass:".popup__input-error_active"})}))})();